/* scheduler_server_config.cpp

 Generated by phxrpc_pb2server from scheduler.proto

*/

#include "scheduler.pb.h"
#include "scheduler_server_config.h"


SchedulerServerConfig::SchedulerServerConfig() {}

SchedulerServerConfig::~SchedulerServerConfig() {}

bool SchedulerServerConfig::Read(const char *config_file) {
    bool ret = ep_server_config_.Read(config_file);

    if (strlen(ep_server_config_.GetPackageName()) == 0) {
        ep_server_config_.SetPackageName(
        phxqueue::comm::proto::GetAddrScaleRequest::default_instance().GetDescriptor()->file()->package().c_str());
    }

    // read Extra
    phxrpc::Config config;
    if (!config.InitConfig(config_file)) {
        return false;
    }
    ret &= config.ReadItem("Scheduler", "Topic", topic_, sizeof(topic_));
    ret &= config.ReadItem("Scheduler", "PhxQueueGlobalConfigPath", phxqueue_global_config_path_, sizeof(phxqueue_global_config_path_));

    return ret;
}

phxrpc::HshaServerConfig &SchedulerServerConfig::GetHshaServerConfig() {
    return ep_server_config_;
}

const char *SchedulerServerConfig::GetTopic() const {
    return topic_;
}

const char *SchedulerServerConfig::GetPhxQueueGlobalConfigPath() const {
    return phxqueue_global_config_path_;
}


//gzrd_Lib_CPP_Version_ID--start
#ifndef GZRD_SVN_ATTR
#define GZRD_SVN_ATTR "0"
#endif
static char gzrd_Lib_CPP_Version_ID[] __attribute__((used))="$HeadURL: http://scm-gy.tencent.com/gzrd/gzrd_mail_rep/phoenix_proj/trunk/phxqueue/phxqueue_phxrpc/src/scheduler/scheduler_server_config.cpp $ $Id: scheduler_server_config.cpp 2143928 2017-06-29 09:20:49Z walnuthe $ " GZRD_SVN_ATTR "__file__";
// gzrd_Lib_CPP_Version_ID--end

